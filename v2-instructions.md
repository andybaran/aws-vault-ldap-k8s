# Overview

You are going to act as an orchestrator for this project to re-factor python-app in "python-app" so that it supports all of the secret delivery methods defined in [this document](/Users/andy.baran/code/vault-ldap-blue-green/FAQ/secret-delivery.md).  We will be presenting this work to a very important customer and they expect the application UI to remain as is. The only change that should be made to the UI is the addition of the secret delivery method display as mentioned below. 

You will act as an orchestrator for this project and ensure that all agents are working together to achieve the desired outcome. The minimum number of agents that should be working on this project are listed in the Agents section below, but you may choose to add more agents if you feel it is necessary to complete the project successfully. 

Each agent should have a clear understanding of their responsibilities and should communicate regularly with the other agents to ensure that everyone is on the same page and that the project is progressing as expected.  The research agent should be the first to run as it will inform the work of the other agents and provide valuable insights into the best way to implement the changes needed to support the new secret delivery methods. The research agent should also be responsible for researching any new technologies or tools that may be needed to support the new secret delivery methods and providing recommendations to the team on how to best implement these changes and ensure that they are compatible with the existing application. The research agent should be utilized by other agents when they need to do more research on a particular topic or technology related to the project. The research agent should be available to assist other agents throughout the project and should be proactive in providing information and insights that may be helpful to the team.

All documentation created by yourself and agents will be stored in the [documentation folder](/Users/andy.baran/code/aws-vault-ldap-k8s/v2) and should be organized in a way that is easy to navigate and understand. Each agent should create a subfolder within the documentation folder to store their documentation and any relevant information related to their work on the project. The documentation should be updated regularly as the project progresses and should include any research findings, implementation details, and any other relevant information that may be useful for the team. This will help ensure that everyone is on the same page and that the project is progressing as expected. The documentation needs to be readable by a human once the project is complete as it will be shared with the customer.

## Agents

1. Python Agent: This agent will be responsible for refactoring the python-app to support the new secret delivery methods and ensuring that the application continues to function as expected. They will also be responsible for writing tests for their code and ensuring that they pass before merging back to main.

2. Kubernetes Agent: This agent will be responsible for creating the necessary Kubernetes resources for the Vault Agent running as a sidecar, CSI driver, VSO and additional python-app deployments. They will also be responsible for deploying these resources to the cluster and ensuring that they are properly configured. Once they are confirmed they should communicate with the Terraform Agent to ensure that the Terraform code is updated to reflect these changes and that the new resources are properly managed through Terraform.

3. UI Agent: This agent will be responsible for making the necessary changes to the UI to display the secret delivery method above the "Next Rotation In" box. They will also be responsible for ensuring that the UI continues to function as expected and that the new display does not disrupt the existing functionality.

4. Documentation Agent: This agent will be responsible for updating the documentation to reflect the changes made to the application, terraform code and the new secret delivery methods. They will also be responsible for ensuring that the documentation is clear and easy to understand for the customer.

5. Testing Agent: This agent will be responsible for testing the application to ensure that it continues to function as expected with the new secret delivery methods. They will also be responsible for writing and executing test cases to validate the functionality of the application and the new features added.

6. Terraform Agent: This agent will be responsible for updating the Terraform code in the [ldap_app](/Users/andy.baran/code/aws-vault-ldap-k8s/modules/ldap_app/ldap_app.tf) module to create new Kubernetes deployments that highlight each deployment method. They will also be responsible for ensuring that the Terraform code is properly configured and that the deployments are successful.  Each deployment will use it's own set of Active Directory user credentials to demonstrate the different secret delivery methods in action. This agent will also be responsible for configuring those.  The terraform agent will alos be responsible for ensuring that the kubernetes resources for the Vault Agent running as a sidecar, CSI driver and VSO are all properly configured and deployed. 

7. Research Agent: This agent will be responsible for researching any new technologies or tools that may be needed to support the new secret delivery methods and researching the existing codebases for the [terraform stacks deployment](/Users/andy.baran/code/aws-vault-ldap-k8s) and the [new ldap secret engine functionality](/Users/andy.baran/code/vault-ldap-blue-green). They will also be responsible for providing recommendations to the team on how to best implement these changes and ensure that they are compatible with the existing application.

8. Terraform Deploy Agent: This agent will be responsible for deploying the Terraform code to the appropriate environments and ensuring that the deployments are successful. They will also be responsible for monitoring the deployments and addressing any issues that may arise during the deployment process. The stack is currently deployed in the organization "andybaran", project "ldap_stack" and stack named "aws-vault-ldap-k8s".

9. GitOps Agent: This agent will be responsible for coordinating the GitOps workflow for the project, ensuring that all changes are properly reviewed and merged in a timely manner. They will also be responsible for communicating with the other agents to ensure that everyone is aware of the status of the project and any changes that may impact their work. They will also be responsible for ensuring that all agents are following the GitOps workflow and that any issues or conflicts are resolved quickly to keep the project moving forward efficiently.

10. Time Tracking Agent: This agent will be responsible for tracking the time spent by each agent on the project and maintaining a CSV file that is updated every 5 seconds with the timestamp and status of each agent. They will also be responsible for creating a simple web application to display and refresh the CSV file in real-time, allowing the team to easily monitor the status of each agent and make adjustments as needed to ensure that the project is progressing efficiently.  They will also build the app to display the CSV file as described in the instructions below. As soon as the app is built, they will share instructions with me on how to open it before any work proceeds. Once I have confirmed that I can access the app and see the real-time updates, the project can proceed. The Time Tracking Agent will also be responsible for ensuring that the CSV file is included in the documentation that is shared with the customer to provide transparency into the work being done and the time spent by each agent on the project.

## Instructions

In order to present we will create more kubernetes deployments in the [ldap_app](/Users/andy.baran/code/aws-vault-ldap-k8s/modules/ldap_app/ldap_app.tf) module to highlight each deployment method. The agents will also need to make sure that the kubernertes resources for the Vault Agent running as a sidecar, CSI driver and VSO are all properly configured and deployed.  Each deployment will use it's own set of Active Directory user credentials to demonstrate the different secret delivery methods in action.

The agents all need to use GitOps and you will coordinate merges. 

It is preferred that the python agent refactor to use the [python-hvac](https://python-hvac.org/en/stable/overview.html) library to interact with vault. One small addition needs to be made to the UI to allow for the secrety delivery method to be displayed above the "Next Rotation In" box. The value should be set as an environment variable that is passed to the application at runtime. The environment variable should be called "SECRET_DELIVERY_METHOD" and should be set to the appropriate value for each deployment method (e.g. "vault-agent-sidecar", "vault-csi-driver", "vault-vso").

Maintain a ToDo list locally and via GitHub issues to track the progress of the project. Each agent should document important decisions, findings and information it believes will be beneficial to other agents in the project. This documentation needs to be accessible to all agents and should be updated regularly as the project progresses. The documentation should include any research findings, implementation details, and any other relevant information that may be useful for the team. This will help ensure that everyone is on the same page and that the project is progressing as expected. The documentation needs to be readable by a human once the project is complete as it will be shared with the customer.

Further, I would like for you to create a document that tracks the time spent by each agent on the project. A key goal of yours is to maximize concurrency and parallel work. Maintain a CSV file that is updated every 5 seconds with the timestamp and status of each agent. The CSV file should have the following columns: "timestamp", "agent_name", "status". The status column should indicate whether the agent is currently working on a task, waiting for another agent, or has completed their work. This will help you track the progress of the project and identify any bottlenecks or areas where agents may be waiting for others to complete their work. You can use this information to adjust the workload and ensure that all agents are working efficiently and effectively to complete the project on time. The CSV file should be updated in real-time and should be accessible to all agents so that they can see the status of their colleagues and adjust their work accordingly. This will help ensure that everyone is aware of the progress of the project and can work together effectively to achieve the desired outcome. The CSV file should also be included in the documentation that is shared with the customer to provide transparency into the work being done and the time spent by each agent on the project. Create a simple web application I can run locally to display and refresh the CSV file in real-time. This will allow you to easily monitor the status of each agent and make adjustments as needed to ensure that the project is progressing efficiently. The web application should be simple and easy to use, with a clear display of the timestamp, agent name, and status for each agent. It should also have a refresh button that allows you to update the display with the latest information from the CSV file. This will help you stay informed about the progress of the project and make any necessary adjustments to ensure that all agents are working effectively towards the successful completion of the project. Instructuons for the web application should be included in the documentation folder and should provide clear guidance on how to set up and run the application locally. The web application should be built using a simple framework such as Flask and should be designed to be lightweight and easy to deploy. It should also include error handling to ensure that it continues to function properly even if there are issues with the CSV file or other components of the application. Overall, this web application will be a valuable tool for monitoring the progress of the project and ensuring that all agents are working together effectively to achieve the desired outcome.